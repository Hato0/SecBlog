<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>OwlGuard: A multi-instance SIEM rule manager. - Hato0 - Blog</title><meta name=Description content="OwlGuard aims to simplify the management of multiple SIEM instances and to manage rules more efficiently."><meta property="og:url" content="https://www.hato0.xyz/posts/blue_team/owlguard/">
<meta property="og:site_name" content="Hato0 - Blog"><meta property="og:title" content="OwlGuard: A multi-instance SIEM rule manager."><meta property="og:description" content="OwlGuard aims to simplify the management of multiple SIEM instances and to manage rules more efficiently."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-05-11T00:00:00+00:00"><meta property="article:modified_time" content="2024-05-11T22:53:23+02:00"><meta property="article:tag" content="Web"><meta property="article:tag" content="Blueteam"><meta property="article:tag" content="Development"><meta property="article:tag" content="Open-Source"><meta name=twitter:card content="summary"><meta name=twitter:title content="OwlGuard: A multi-instance SIEM rule manager."><meta name=twitter:description content="OwlGuard aims to simplify the management of multiple SIEM instances and to manage rules more efficiently."><meta name=application-name content="Hato0's journey"><meta name=apple-mobile-web-app-title content="Hato0's journey"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://www.hato0.xyz/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://www.hato0.xyz/posts/blue_team/owlguard/><link rel=prev href=https://www.hato0.xyz/posts/ctf/huntress/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"OwlGuard: A multi-instance SIEM rule manager.","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.hato0.xyz\/posts\/blue_team\/owlguard\/"},"genre":"posts","keywords":"web, blueteam, development, Open-Source","wordcount":1034,"url":"https:\/\/www.hato0.xyz\/posts\/blue_team\/owlguard\/","datePublished":"2024-05-11T00:00:00+00:00","dateModified":"2024-05-11T22:53:23+02:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Hato0"},"description":"OwlGuard aims to simplify the management of multiple SIEM instances and to manage rules more efficiently."}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Hato0 - Blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=https://www.hato0.xyz/favicon.png data-srcset="https://www.hato0.xyz/favicon.png, https://www.hato0.xyz/favicon.png 1.5x, https://www.hato0.xyz/favicon.png 2x" data-sizes=auto alt=https://www.hato0.xyz/favicon.png title=https://www.hato0.xyz/favicon.png></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/>About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Hato0 - Blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=https://www.hato0.xyz/favicon.png data-srcset="https://www.hato0.xyz/favicon.png, https://www.hato0.xyz/favicon.png 1.5x, https://www.hato0.xyz/favicon.png 2x" data-sizes=auto alt=https://www.hato0.xyz/favicon.png title=https://www.hato0.xyz/favicon.png></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">OwlGuard: A multi-instance SIEM rule manager.</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Hato0</a></span>&nbsp;<span class=post-category>included in <a href><i class="far fa-folder fa-fw" aria-hidden=true></i></a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2024-05-11>2024-05-11</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1034 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;5 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#summary>Summary</a></li><li><a href=#language-used>Language used</a></li><li><a href=#functionalities>Functionalities</a><ul><li><a href=#rule-management>Rule management</a></li><li><a href=#connectors>Connectors</a></li><li><a href=#documentation-and-test-scripts>Documentation and Test scripts</a></li></ul></li><li><a href=#usage>Usage</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div><div class=content id=content><h2 id=summary>Summary</h2><p>OwlGuard is a platform designed to provide security teams a better way to manage SIEM rules. This tool aims to onboard clients efficiently just by using already developed rules and a simple connection to their SIEM. For now, only SPLUNK is supported, if the project get interest, other SIEM will be included in the support list.</p><h2 id=language-used>Language used</h2><p>When I&rsquo;m doing a project, I&rsquo;m not only doing it to develop something that will be helpful for me or other but also to learn new things. In that case, I&rsquo;ve chosen to develop the application using Django.
Django is a web python framework used by many companies to create dynamic applications. I nevered used Django (used Flask previously for web app in Python) so it was a good way to try it out. This framework fits pretty well with the needs of this application (background task, multiple threads, Python, &mldr;) so why not giving it a shot?
Looking back, that choice was on point with the requirements and I&rsquo;m happy to have learned a new framework.</p><h2 id=functionalities>Functionalities</h2><p>In term of functionalities, this application covers pretty much all your needs for rule management (except very specific ones). Let&rsquo;s break them down one by one.</p><h3 id=rule-management>Rule management</h3><p>The main purpose of this tool was to centralize the management of rules for big companies with multiple SIEM/Client to manage at once. This can also help companies that are regularly changing SIEM to avoid the constant switch and redevelopment of rules.</p><p>The rule management system is built on two main components:</p><ul><li>SIGMA base interactions.</li><li>Direct connection to the SIEM using their API.</li></ul><p>To base myself on SIGMA was obvious as this is the only generic and widely used format. The application allow you to import yaml file in a SIGMA format to create new rules. Any modification to the rule in the application will be automatically replicated to the SIGMA file stored on the server.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/tools/OwlGuard/upload_view.png data-srcset="https://www.hato0.xyz/images/tools/OwlGuard/upload_view.png, https://www.hato0.xyz/images/tools/OwlGuard/upload_view.png 1.5x, https://www.hato0.xyz/images/tools/OwlGuard/upload_view.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/tools/OwlGuard/upload_view.png title="Upload pannel"></p><p>The application also gives the possibility to any user to view the rule and the versioning <em>(for all features inside OwlGuard a history is kept for all modifications)</em>. A filtering on tags (mitre, custom, etc) is also possible to quickly understand the coverage of a particular technic or actor.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/tools/OwlGuard/overviewRule.png data-srcset="https://www.hato0.xyz/images/tools/OwlGuard/overviewRule.png, https://www.hato0.xyz/images/tools/OwlGuard/overviewRule.png 1.5x, https://www.hato0.xyz/images/tools/OwlGuard/overviewRule.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/tools/OwlGuard/overviewRule.png title="Overview rule dashboard"></p><p>The rule details and the history:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/tools/OwlGuard/history.png data-srcset="https://www.hato0.xyz/images/tools/OwlGuard/history.png, https://www.hato0.xyz/images/tools/OwlGuard/history.png 1.5x, https://www.hato0.xyz/images/tools/OwlGuard/history.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/tools/OwlGuard/history.png title="Rule history"></p><p>In the screen above, you can also see a column &lsquo;Status by Connector&rsquo;. This column indicates the status of each rules for each connectors. In this example, only one has been created (can only access one demo instance in my home lab), but in case of multiple instances you will be able to quickly identify status anomalies. The platform provides you with an easy way to associate rules to SIEM through their connector as you can see below:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/tools/OwlGuard/associate.png data-srcset="https://www.hato0.xyz/images/tools/OwlGuard/associate.png, https://www.hato0.xyz/images/tools/OwlGuard/associate.png 1.5x, https://www.hato0.xyz/images/tools/OwlGuard/associate.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/tools/OwlGuard/associate.png title="Associate connector/rule"></p><p>And to adjust their status also (only if associated with the connector):</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/tools/OwlGuard/status.png data-srcset="https://www.hato0.xyz/images/tools/OwlGuard/status.png, https://www.hato0.xyz/images/tools/OwlGuard/status.png 1.5x, https://www.hato0.xyz/images/tools/OwlGuard/status.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/tools/OwlGuard/status.png title="Rule status by connector"></p><p>As you probably saw on the screen above, a Splunk logo is to be seen in the detection section. This is the case for rules that have been onboarded into a Splunk instance through OwlGuard. You will be able to view the SPL query and to modify it if needed just by clicking on the Splunk logo. In the default configuration, OwlGuard will update the SIEM with modifications every 15 mins in a bidirectional way (SIEM modifications will be included to OwlGuard and vice versa).</p><h3 id=connectors>Connectors</h3><p>Connectors are the way to connect OwlGuard to SIEMs. You can have as many connectors as you want, just to keep in mind, for now only Splunk is supported as this is the only one for which I was able to have a developer licence for now, will continue the development if this tool gets some interest.</p><p>So how to register a connector? That&rsquo;s pretty simple, you will only need a few pieces of information, like the endpoint of your SIEM, API credentials, and that&rsquo;s pretty much it. Before the creation, OwlGuard will try to perform a test connection to ensure a proper setup.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/tools/OwlGuard/connector.png data-srcset="https://www.hato0.xyz/images/tools/OwlGuard/connector.png, https://www.hato0.xyz/images/tools/OwlGuard/connector.png 1.5x, https://www.hato0.xyz/images/tools/OwlGuard/connector.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/tools/OwlGuard/connector.png title="Connector add"></p><p>Once you have set your connector, you will be able to use the rule functionalities described above (especially the association and the status). You will also be able to switch from one connector to the other to only have the data for a specific connector (on the top right of the nav bar). The global view without being connector specific will always be available.</p><p>The main page of the connector section will provide you with an overview of the connectors and switch colors depending on the state of the connector (light red=enable but not focus, green=enable and focus, red=disable).</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/tools/OwlGuard/connectorPage.png data-srcset="https://www.hato0.xyz/images/tools/OwlGuard/connectorPage.png, https://www.hato0.xyz/images/tools/OwlGuard/connectorPage.png 1.5x, https://www.hato0.xyz/images/tools/OwlGuard/connectorPage.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/tools/OwlGuard/connectorPage.png title="Connector dash"></p><h3 id=documentation-and-test-scripts>Documentation and Test scripts</h3><p>I&rsquo;ve merged those two topics because they are quite similar in terms of functionality for now.
The documentation will provide you with a way to indicate to your analyst how to handle the rule and specify any action to perform for remediation. The Offensive Script section will provide you a way to manage your testing script for each rules and to ensure that you can test rules if needed. Both functionalities can be link to specific rules. The main dashboard provides an indication on which rules are not documented yet as long as some statistics.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/tools/OwlGuard/mainDash.png data-srcset="https://www.hato0.xyz/images/tools/OwlGuard/mainDash.png, https://www.hato0.xyz/images/tools/OwlGuard/mainDash.png 1.5x, https://www.hato0.xyz/images/tools/OwlGuard/mainDash.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/tools/OwlGuard/mainDash.png title="Connector dash"></p><p>One feature that I&rsquo;ve in mind for the future to be integrated (again, if folks are interested in using the tool) is to give the possibility to launch test scripts and assess the results (detected or not) directly from OwlGuard. This would enable security teams to have a rapid checkup of their SIEM health or rule health.</p><h2 id=usage>Usage</h2><p>The project&rsquo;s <a href=https://github.com/Hato0/OwlGuard target=_blank rel="noopener noreffer">README</a> should be pretty clear on how to run the project but anyway if you need help, feel free to reach me will be happy to show you around.</p><h2 id=conclusion>Conclusion</h2><p>This tool was used in a real life exercise over two weeks and some bugs have been founds but all of them have been corrected since. Pretty happy with the result I had.
OwlGuard reflect my vision of rule management that is not perfect but tried to create a tool accessible and usable by everyone to have a better management and overview of what&rsquo;s going on in their environment.</p><p>Was a good way to deep dive into Django and to challenge a bit my coding/scripting abilities. Onto the next one!</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2024-05-11&nbsp;<a class=git-hash href=https://github.com/Hato0/hato0.github.io/commit/06a1111179a4c9549404cd3c6884922787ce3cc8 target=_blank title="commit by Hato0(contact@hato0.xyz) 06a1111179a4c9549404cd3c6884922787ce3cc8: OwlGuard article release">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>06a1111</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://www.hato0.xyz/posts/blue_team/owlguard/ data-title="OwlGuard: A multi-instance SIEM rule manager." data-hashtags=web,blueteam,development,Open-Source><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://www.hato0.xyz/posts/blue_team/owlguard/ data-hashtag=web><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://www.hato0.xyz/posts/blue_team/owlguard/ data-title="OwlGuard: A multi-instance SIEM rule manager."><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://www.hato0.xyz/posts/blue_team/owlguard/ data-title="OwlGuard: A multi-instance SIEM rule manager."><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://www.hato0.xyz/posts/blue_team/owlguard/ data-title="OwlGuard: A multi-instance SIEM rule manager."><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/web/>Web</a>,&nbsp;<a href=/tags/blueteam/>Blueteam</a>,&nbsp;<a href=/tags/development/>Development</a>,&nbsp;<a href=/tags/open-source/>Open-Source</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/ctf/huntress/ class=prev rel=prev title="CTF: Huntress CTF"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>CTF: Huntress CTF</a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>hato0 dedicated blog @2022</div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>